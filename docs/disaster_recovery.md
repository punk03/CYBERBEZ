# Disaster Recovery Plan

## Обзор

План восстановления после катастроф (Disaster Recovery Plan) для системы PROKVANT.

## Цели восстановления

- **RTO (Recovery Time Objective)**: 4 часа
- **RPO (Recovery Point Objective)**: 1 час
- **Максимальная потеря данных**: 1 час

## Компоненты системы

### Критические компоненты

1. **Базы данных**
   - PostgreSQL/TimescaleDB
   - MongoDB
   - Elasticsearch

2. **Streaming платформа**
   - Kafka
   - Zookeeper

3. **Приложения**
   - Backend API
   - Log processors
   - ML engines

4. **Frontend**
   - Web dashboard

## Процедуры резервного копирования

### Автоматическое резервное копирование

- **Частота**: Ежедневно в 02:00 UTC
- **Хранение**: 30 дней
- **Локация**: Локальное хранилище + удаленное хранилище (опционально)

### Ручное резервное копирование

```bash
./scripts/backup.sh
```

### Компоненты бэкапа

1. PostgreSQL dump
2. MongoDB dump
3. Конфигурационные файлы
4. ML модели
5. Manifest файл

## Процедуры восстановления

### Восстановление из бэкапа

```bash
./scripts/restore.sh /path/to/backup.tar.gz
```

### Пошаговое восстановление

1. **Остановка сервисов**
   ```bash
   docker-compose down
   ```

2. **Восстановление баз данных**
   - PostgreSQL
   - MongoDB

3. **Восстановление конфигурации**
   - Конфигурационные файлы
   - Переменные окружения

4. **Восстановление ML моделей**
   - Загрузка моделей из бэкапа

5. **Запуск сервисов**
   ```bash
   docker-compose up -d
   ```

6. **Проверка работоспособности**
   - Health checks
   - Тестовые запросы

## Сценарии восстановления

### Сценарий 1: Потеря базы данных

1. Остановить приложение
2. Восстановить БД из бэкапа
3. Запустить приложение
4. Проверить работоспособность

### Сценарий 2: Потеря всего сервера

1. Развернуть новую инфраструктуру
2. Восстановить из последнего бэкапа
3. Настроить интеграции
4. Запустить систему

### Сценарий 3: Частичная потеря данных

1. Определить временной диапазон потери
2. Восстановить из соответствующего бэкапа
3. Проверить целостность данных

## Тестирование DR плана

- **Частота**: Ежеквартально
- **Тип тестирования**: Восстановление на тестовой среде
- **Документирование**: Все тесты документируются

## Контакты для экстренных ситуаций

- **Техническая поддержка**: [указать контакты]
- **Менеджер инцидентов**: [указать контакты]
- **Резервные контакты**: [указать контакты]

## Примечания

- Все бэкапы должны быть зашифрованы
- Доступ к бэкапам должен быть ограничен
- Регулярное тестирование процедур восстановления обязательно
